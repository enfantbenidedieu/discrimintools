
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>discrimintools.discriminant_analysis._stepdisc &#8212; discrimintools 0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/discrimintools/discriminant_analysis/_stepdisc';</script>
    <link rel="icon" href="../../../_static/discrimintools.svg"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/discrimintools.svg" class="logo__image only-light" alt=""/>
    <img src="../../../_static/discrimintools.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">discrimintools</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/install/index.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/examples/index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/enfantbenidedieu/discrimintools" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/install/index.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/examples/index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/enfantbenidedieu/discrimintools" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">discrimintools.discriminant_analysis._stepdisc</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for discrimintools.discriminant_analysis._stepdisc</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linalg</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">zeros</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">namedtuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.utils.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_is_fitted</span>

<span class="c1">#intern functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._base</span><span class="w"> </span><span class="kn">import</span> <span class="n">_BaseDA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._discrim</span><span class="w"> </span><span class="kn">import</span> <span class="n">DISCRIM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._candisc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CANDISC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.functions.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_is_dataframe</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.functions.splitmix</span><span class="w"> </span><span class="kn">import</span> <span class="n">splitmix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.functions.tab_disjunctive</span><span class="w"> </span><span class="kn">import</span> <span class="n">tab_disjunctive</span>

<div class="viewcode-block" id="STEPDISC">
<a class="viewcode-back" href="../../../source/reference/discriminant_analysis/discrimintools.discriminant_analysis.STEPDISC.html#discrimintools.discriminant_analysis.STEPDISC">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">STEPDISC</span><span class="p">(</span><span class="n">_BaseDA</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stepwise Discriminant Analysis (STEPDISC)</span>
<span class="sd">    </span>
<span class="sd">    Given a classification variable and several quantitative variables, the :class:`~discrimintools.discriminant_analysis.STEPDISC` class performs a</span>
<span class="sd">    stepwise discriminant analysis to select a subset of the quantitative variables for use in discriminating among</span>
<span class="sd">    the classes. The set of variables that make up each class is assumed to be multivariate normal with a common</span>
<span class="sd">    covariance matrix. The :class:`~discrimintools.discriminant_analysis.STEPDISC` class can use forward selection and backward elimination, </span>
<span class="sd">    which is a useful prelude to further analyses with the :class:`~discrimintools.discriminant_analysis.CANDISC` class or the :class:`~discrimintools.discriminant_analysis.DISCRIM` class.</span>

<span class="sd">    With :class:`~discrimintools.discriminant_analysis.STEPDISC`, variables are chosen to enter or leave the model according to the significance level of an `F` test from an analysis of covariance, </span>
<span class="sd">    where the variables already chosen act as covariates and the variable under consideration is the dependent variable.</span>
<span class="sd">    Two selection methods are available: &#39;forward&#39; and &#39;backward&#39;:</span>

<span class="sd">    1. Forward selection begins with no variables in the model. At each step, :class:`~discrimintools.discriminant_analysis.STEPDISC` enters the variable that contributes most to the discriminatory power of the model as measured by Wilks&#39; lambda, the likelihood ratio criterion. When none of the unselected variables meet the entry criterion, the forward selection process stops.</span>
<span class="sd">    2. Backward elimination begins with all variables in the model except those that are linearly dependent on previous variables in the VAR statement. At each step, the variable that contributes least to the discriminatory power of the model as measured by Wilks&#39; lambda is removed. When all remaining variables meet the criterion to stay in the model, the backward elimination process stops.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    method : {&#39;backward&#39;,&#39;forward&#39;}, default=&#39;forward&#39;</span>
<span class="sd">        The feature selection method to be used, possible values:</span>
<span class="sd">        - &quot;forward&quot; for forward selection, </span>
<span class="sd">        - &quot;backward&quot; for backward elimination</span>
<span class="sd">    </span>
<span class="sd">    alpha : float, default = 1e-2</span>
<span class="sd">        The significance level for adding or retaining variables in stepwise variable selection.</span>
<span class="sd">    </span>
<span class="sd">    lambda_init : None or float, default = None</span>
<span class="sd">        Initial Wilks Lambda.</span>
<span class="sd">    </span>
<span class="sd">    verbose : bool, default=True </span>
<span class="sd">        If `True`, print intermediary steps during feature selection (default)</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    call_ : NamedTuple</span>
<span class="sd">        Call informations:</span>

<span class="sd">        - obj : class</span>
<span class="sd">            An object of class CANDISC, DISCRIM</span>
<span class="sd">        - alpha : float</span>
<span class="sd">            The significance level for adding or retaining variables in stepwise variable selection.</span>
<span class="sd">        - target : str</span>
<span class="sd">            Name of target.</span>
<span class="sd">        - classes : list</span>
<span class="sd">            Names of classes</span>
<span class="sd">        - priors : Series of shape (n_classes,)</span>
<span class="sd">            Priors probabilities.</span>

<span class="sd">    disc_ : class</span>
<span class="sd">        An object of class CANDISC or DISCRIM</span>

<span class="sd">    model_ : str, default = &quot;stepdisc&quot;</span>
<span class="sd">        Name of model fitted.</span>
<span class="sd">        </span>
<span class="sd">    summary_ : NamedTuple</span>
<span class="sd">        Stepwise summary informations:</span>
<span class="sd">        </span>
<span class="sd">        - summary : DataFrame of shape (n_selected, 6)</span>
<span class="sd">            Summary of stepwise selection</span>
<span class="sd">        - selected : list</span>
<span class="sd">            Selected variables</span>
<span class="sd">        - removed : list</span>
<span class="sd">            Removed variables</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`~discrimintools.discriminant_analysis.CANDISC`</span>
<span class="sd">        Canonical Discriminant Analysis (CANDISC)</span>
<span class="sd">    :class:`~discrimintools.discriminant_analysis.DISCRIM`</span>
<span class="sd">        Discriminant Analysis (linear and quadratic).</span>
<span class="sd">    :class:`~discrimintools.summary.summaryCANDISC`</span>
<span class="sd">        Printing summaries of Canonical Discriminant Analysis model.</span>
<span class="sd">    :class:`~discrimintools.summary.summaryDISCRIM`</span>
<span class="sd">        Printing summaries of Discriminant Analysis (linear and quadratic) model.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    [1] Ricco Rakotomalala (2008), « `STEPDISC - Feature selection for LDA`_ », Université Lumière Lyon 2.</span>

<span class="sd">    [2] Ricco Rakotomalala (2012), « `Linear Discriminant Analysis - Tools comparison`_ », Université Lumière Lyon 2.</span>

<span class="sd">    [3] Ricco Rakotomalala (2014), « `Linear discriminant analysis (slides)`_ », Université Lumière Lyon 2.</span>

<span class="sd">    [4] Ricco Rakotomalala (2020), « `Pratique de l&#39;Analyse Discriminante Linéaire`_ », Version 1.0, Université Lumière Lyon 2.</span>

<span class="sd">    [5] SAS/STAT 13.1 User&#39;s Guide (2013), « `The STEPDISC Procedure`_ », Chapter 93.</span>

<span class="sd">    .. _STEPDISC - Feature selection for LDA: https://eric.univ-lyon2.fr/ricco/tanagra/fichiers/en_Tanagra_Stepdisc.pdf</span>
<span class="sd">    .. _Linear Discriminant Analysis - Tools comparison: https://eric.univ-lyon2.fr/ricco/tanagra/fichiers/en_Tanagra_LDA_Comparisons.pdf</span>
<span class="sd">    .. _Linear discriminant analysis (slides): https://eric.univ-lyon2.fr/ricco/cours/slides/en/analyse_discriminante.pdf</span>
<span class="sd">    .. _Pratique de l&#39;Analyse Discriminante Linéaire: https://hal.science/hal-04868585v1/file/Pratique_Analyse_Discriminante_Lineaire.pdf</span>
<span class="sd">    .. _The STEPDISC Procedure: https://support.sas.com/documentation/onlinedoc/stat/131/stepdisc.pdf</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from discrimintools.datasets import load_heart</span>
<span class="sd">    &gt;&gt;&gt; from discrimintools import DISCRIM, STEPDISC</span>
<span class="sd">    &gt;&gt;&gt; D = load_heart(&quot;train&quot;) # load training data</span>
<span class="sd">    &gt;&gt;&gt; y, X = D[&quot;disease&quot;], D.drop(columns=[&quot;disease&quot;]) # split into X and y</span>
<span class="sd">    &gt;&gt;&gt; clf = DISCRIM(method=&quot;linear&quot;)</span>
<span class="sd">    &gt;&gt;&gt; clf.fit(X,y)</span>
<span class="sd">    &gt;&gt;&gt; clf2 = STEPDISC(method=&quot;forward&quot;,alpha=0.01,verbose=True)</span>
<span class="sd">    &gt;&gt;&gt; clf2.fit(clf)</span>
<span class="sd">    STEPDISC()</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="STEPDISC.__init__">
<a class="viewcode-back" href="../../../source/reference/discriminant_analysis/discrimintools.discriminant_analysis.STEPDISC.html#discrimintools.discriminant_analysis.STEPDISC.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">lambda_init</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda_init</span> <span class="o">=</span> <span class="n">lambda_init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">decision_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply decision function to an input data</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : DataFrame of shape (n_samples, n_features)</span>
<span class="sd">            Input data, where ``n_samples`` is the number of samples and ``n_features`` is the number of features.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        C : DataFrame of shape (n_samples, n_classes)</span>
<span class="sd">            Decision function values related to each class, per sample.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#check if the estimator is fitted by verifying the presence of fitted attributes</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1">#check if model has been updated</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;disc_&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Since only one feature is selected, </span><span class="si">{}</span><span class="s2"> procedure cannot be updated, therefore decision_function cannot be applied.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#check if X is an instance of class pd.DataFrame</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="n">check_is_dataframe</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>

        <span class="c1">#set index name as None</span>
        <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#check if X contains original features</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">Xtot</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The names of the features is not the same as the ones in the active features of the </span><span class="si">{}</span><span class="s2"> result&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">model_</span><span class="p">))</span>
        
        <span class="c1">#select original features</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">Xtot</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

        <span class="c1">#split X</span>
        <span class="n">split_X</span> <span class="o">=</span> <span class="n">splitmix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="c1">#extract elements</span>
        <span class="n">X_quanti</span><span class="p">,</span> <span class="n">X_quali</span><span class="p">,</span> <span class="n">n_quanti</span><span class="p">,</span> <span class="n">n_quali</span> <span class="o">=</span> <span class="n">split_X</span><span class="o">.</span><span class="n">quanti</span><span class="p">,</span> <span class="n">split_X</span><span class="o">.</span><span class="n">quali</span><span class="p">,</span> <span class="n">split_X</span><span class="o">.</span><span class="n">k1</span><span class="p">,</span> <span class="n">split_X</span><span class="o">.</span><span class="n">k2</span>

        <span class="c1">#initialize DataFrame</span>
        <span class="n">Xcod</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1">#check if numerics variables</span>
        <span class="k">if</span> <span class="n">n_quanti</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#replace with numerics columns</span>
            <span class="n">Xcod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">X_quanti</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_quanti</span>
        
        <span class="c1">#check if categorical variables      </span>
        <span class="k">if</span> <span class="n">n_quali</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#active categorics</span>
            <span class="n">categorics</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">Xtot</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
            <span class="c1">#replace with dummies</span>
            <span class="n">Xcod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">categorics</span><span class="p">]</span> <span class="o">=</span> <span class="n">tab_disjunctive</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_quali</span><span class="p">,</span><span class="n">dummies_cols</span><span class="o">=</span><span class="n">categorics</span><span class="p">,</span><span class="n">prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="c1">#remove non selected variables</span>
        <span class="n">Xcod</span> <span class="o">=</span> <span class="n">Xcod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">cov_</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">disc_</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">Xcod</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit Stepwise Discriminant Analysis procedure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : class</span>
<span class="sd">            An object of class CANDISC, DISCRIM</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : object</span>
<span class="sd">            Returns the instance itself        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Wilks lambda</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">wilks</span><span class="p">(</span><span class="n">Vb</span><span class="p">,</span> <span class="n">Wb</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Compute Wilk&#39;s Lambda</span>

<span class="sd">            Parameters</span>
<span class="sd">            ---------</span>
<span class="sd">            Vb : DataFrame of shape (n_features, n_features)</span>
<span class="sd">                Biaised total covariance matrix</span>

<span class="sd">            Wb : DataFrame of shape (n_features, n_features)</span>
<span class="sd">                Biaised pooled within-class covariance matrix</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            value : Wilk&#39;s Lambda</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Wb</span><span class="p">)</span><span class="o">/</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Vb</span><span class="p">)</span>
        
        <span class="c1"># Wilks lambda</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">wilks_log</span><span class="p">(</span><span class="n">Vb</span><span class="p">,</span><span class="n">Wb</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Compute Wilk&#39;s Lambda</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            Vb : DataFrame of shape (n_features, n_features)</span>
<span class="sd">                Biaised total covariance matrix</span>

<span class="sd">            Wb : DataFrame of shape (n_features, n_features)</span>
<span class="sd">                Biaised pooled within-class covariance matrix</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            value : Wilks Lambda</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">detVb</span><span class="p">,</span> <span class="n">detWb</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="n">Vb</span><span class="p">),</span> <span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="n">Wb</span><span class="p">)</span>  
            <span class="c1"># intra-classes biaisée</span>
            <span class="k">return</span> <span class="n">exp</span><span class="p">((</span><span class="n">detWb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">detWb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="n">detVb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">detVb</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#check if valid discriminan analysis model</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">model_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;discrim&quot;</span><span class="p">,</span> <span class="s2">&quot;candisc&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;model&#39; must be an object of class DISCRIM, CANDISC&quot;</span><span class="p">)</span>
        
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#check if linear discriminant analysis</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">model_</span> <span class="o">==</span> <span class="s2">&quot;discrim&quot;</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Only applied for linear discriminant analysis.&quot;</span><span class="p">)</span>
        
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#check if alpha has a valid value</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1e-2</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not supported&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the &#39;alpha&#39; value </span><span class="si">{}</span><span class="s2"> is not within the required range of 0 and 1.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
        
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#initialize all elements</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#extract active elements : number of samples, number of features and number of classes</span>
        <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_classes</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">n_features</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">n_classes</span>
        <span class="c1">#extract total covariance and pooled withon covariance matrices</span>
        <span class="n">tcovb</span><span class="p">,</span> <span class="n">pwcovb</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">cov_</span><span class="o">.</span><span class="n">btotal</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">cov_</span><span class="o">.</span><span class="n">bpooled</span>

        <span class="c1">#initialize</span>
        <span class="n">var_names</span><span class="p">,</span> <span class="n">col_names</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Wilks&#39; Lambda&quot;</span><span class="p">,</span><span class="s2">&quot;Partial R-Square&quot;</span><span class="p">,</span><span class="s2">&quot;F Value&quot;</span><span class="p">,</span><span class="s2">&quot;Num DF&quot;</span><span class="p">,</span><span class="s2">&quot;Den DF&quot;</span><span class="p">,</span><span class="s2">&quot;Pr&gt;F&quot;</span><span class="p">]</span>

        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#forward procedure</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
            <span class="n">entered_var_list</span><span class="p">,</span> <span class="n">entered_var_summary</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="c1">#wilk&#39;s lambda value for q = 0</span>
            <span class="n">lw_init</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1">#iteration</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
                <span class="n">infos_vars</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">var_names</span><span class="p">:</span>
                    <span class="c1">#update entered var list</span>
                    <span class="n">var_select</span> <span class="o">=</span> <span class="n">entered_var_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="c1"># Wilks Lambda</span>
                    <span class="n">lw</span> <span class="o">=</span> <span class="n">wilks_log</span><span class="p">(</span><span class="n">tcovb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">var_select</span><span class="p">,</span> <span class="n">var_select</span><span class="p">],</span><span class="n">pwcovb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">var_select</span><span class="p">,</span> <span class="n">var_select</span><span class="p">])</span>
                    <span class="c1">#degree of Freedom</span>
                    <span class="n">ddl1</span><span class="p">,</span> <span class="n">ddl2</span> <span class="o">=</span> <span class="n">n_classes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">-</span> <span class="n">n_classes</span> <span class="o">-</span> <span class="n">q</span>
                    <span class="c1">#fisher statistic</span>
                    <span class="n">f_value</span> <span class="o">=</span> <span class="n">ddl2</span><span class="o">/</span><span class="n">ddl1</span> <span class="o">*</span> <span class="p">((</span><span class="n">lw_init</span><span class="o">/</span><span class="n">lw</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="c1">#partial R squared</span>
                    <span class="n">partiel_rsq</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">lw</span><span class="o">/</span><span class="n">lw_init</span><span class="p">)</span>
                    <span class="c1">#critical probability</span>
                    <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">f_value</span><span class="p">,</span> <span class="n">ddl1</span><span class="p">,</span> <span class="n">ddl2</span><span class="p">)</span>
                    <span class="c1">#concatenate</span>
                    <span class="n">infos_vars</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lw</span><span class="p">,</span> <span class="n">partiel_rsq</span><span class="p">,</span> <span class="n">f_value</span><span class="p">,</span> <span class="n">ddl1</span><span class="p">,</span> <span class="n">ddl2</span><span class="p">,</span> <span class="n">p_value</span><span class="p">))</span>

                <span class="c1">#convert to DataFrame</span>
                <span class="n">infos_step_results</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">infos_vars</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">var_names</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>

                <span class="c1">#to print step result</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">====================== Step </span><span class="si">{}</span><span class="s2"> forward selection results =======================&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">infos_step_results</span><span class="p">)</span>

                <span class="c1">#apply criteria decision</span>
                <span class="n">entered_var</span> <span class="o">=</span> <span class="n">infos_step_results</span><span class="p">[</span><span class="s2">&quot;Wilks&#39; Lambda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
                <span class="c1">#test</span>
                <span class="k">if</span> <span class="n">infos_step_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entered_var</span><span class="p">,</span> <span class="s2">&quot;Pr&gt;F&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No variable can enter</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#print </span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variable </span><span class="si">{}</span><span class="s2"> will enter</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entered_var</span><span class="p">))</span>
                    <span class="n">entered_var_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entered_var</span><span class="p">)</span>
                    <span class="c1">#update var names</span>
                    <span class="n">var_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">entered_var</span><span class="p">)</span>
                    <span class="c1">#update lw init</span>
                    <span class="n">lw_init</span> <span class="o">=</span> <span class="n">infos_step_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entered_var</span><span class="p">,</span><span class="s2">&quot;Wilks&#39; Lambda&quot;</span><span class="p">]</span>
                    <span class="c1">#append summary</span>
                    <span class="n">entered_var_summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">infos_step_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entered_var</span><span class="p">]))</span>
                    
            <span class="n">stepdisc_summary</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">entered_var_summary</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">entered_var_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
            
            <span class="c1">#selected variables</span>
            <span class="n">selected_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">stepdisc_summary</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1">#removed variables</span>
            <span class="n">removed_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">var_names</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selected_vars</span><span class="p">]</span>

        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#backward procedure</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;backward&quot;</span><span class="p">:</span>
            <span class="n">removed_var_list</span><span class="p">,</span> <span class="n">removed_var_summary</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="c1">#wilk&#39;s lambda value for pour q = p</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lw_init</span> <span class="o">=</span> <span class="n">wilks</span><span class="p">(</span><span class="n">tcovb</span><span class="p">,</span><span class="n">pwcovb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lw_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_init</span>
            
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">infos_vars</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">var_names</span><span class="p">:</span>
                    <span class="c1">#update lisrt of variables</span>
                    <span class="n">var_select</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">var_names</span> <span class="k">if</span> <span class="n">var</span> <span class="o">!=</span> <span class="n">name</span><span class="p">]</span>
                    <span class="c1">#calcul du Lambda de Wilks (q-1)</span>
                    <span class="n">lw</span> <span class="o">=</span> <span class="n">wilks_log</span><span class="p">(</span><span class="n">tcovb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">var_select</span><span class="p">,</span><span class="n">var_select</span><span class="p">],</span><span class="n">pwcovb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">var_select</span><span class="p">,</span> <span class="n">var_select</span><span class="p">])</span>
                    <span class="c1">#degree of freedom</span>
                    <span class="n">ddl1</span><span class="p">,</span> <span class="n">ddl2</span> <span class="o">=</span> <span class="n">n_classes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">-</span> <span class="n">n_classes</span> <span class="o">-</span> <span class="n">q</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="c1">#fisher statistic</span>
                    <span class="n">f_value</span> <span class="o">=</span> <span class="n">ddl2</span><span class="o">/</span><span class="n">ddl1</span><span class="o">*</span><span class="p">((</span><span class="n">lw</span><span class="o">/</span><span class="n">lw_init</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="c1">#partial Rsquared</span>
                    <span class="n">partiel_rsq</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">lw_init</span><span class="o">/</span><span class="n">lw</span><span class="p">)</span>
                    <span class="c1">#critical probability</span>
                    <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">f_value</span><span class="p">,</span> <span class="n">ddl1</span><span class="p">,</span> <span class="n">ddl2</span><span class="p">)</span>
                    <span class="c1">#add to list</span>
                    <span class="n">infos_vars</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lw</span><span class="p">,</span> <span class="n">partiel_rsq</span><span class="p">,</span><span class="n">f_value</span><span class="p">,</span><span class="n">ddl1</span><span class="p">,</span><span class="n">ddl2</span><span class="p">,</span><span class="n">p_value</span><span class="p">))</span>

                <span class="c1">#convert to DataFrame</span>
                <span class="n">infos_step_results</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">infos_vars</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">var_names</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>

                <span class="c1">#po print step result</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">====================== Step </span><span class="si">{}</span><span class="s2"> backward selection results =======================&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_features</span> <span class="o">-</span> <span class="n">q</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">infos_step_results</span><span class="p">)</span>

                <span class="c1">#apply criteria decision</span>
                <span class="n">removed_var</span> <span class="o">=</span> <span class="n">infos_step_results</span><span class="p">[</span><span class="s2">&quot;Wilks&#39; Lambda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">infos_step_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">removed_var</span><span class="p">,</span> <span class="s2">&quot;Pr&gt;F&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No variable can be removed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#print </span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variable </span><span class="si">{}</span><span class="s2"> will be removed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">removed_var</span><span class="p">))</span>

                    <span class="n">removed_var_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">removed_var</span><span class="p">)</span>
                    <span class="c1">#remove variables in global list</span>
                    <span class="n">var_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">removed_var</span><span class="p">)</span>
                    <span class="c1">#add</span>
                    <span class="n">removed_var_summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">infos_step_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">removed_var</span><span class="p">]))</span>
                    <span class="c1">#update init wilk&#39;s lambda</span>
                    <span class="n">lw_init</span> <span class="o">=</span> <span class="n">infos_step_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">removed_var</span><span class="p">,</span><span class="s2">&quot;Wilks&#39; Lambda&quot;</span><span class="p">]</span>

            <span class="n">stepdisc_summary</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">removed_var_summary</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">removed_var_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>

            <span class="c1">#excluded variables</span>
            <span class="n">removed_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">stepdisc_summary</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1">#selected variables</span>
            <span class="n">selected_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">var_names</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">removed_vars</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method should be one of &#39;backward&#39;, &#39;forward&#39;.&quot;</span><span class="p">)</span>
        
        <span class="c1">#summary of stepwise discriminant analysis</span>
        <span class="n">summary_</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">summary</span><span class="o">=</span><span class="n">stepdisc_summary</span><span class="p">,</span><span class="n">selected</span><span class="o">=</span><span class="n">selected_vars</span><span class="p">,</span><span class="n">removed</span><span class="o">=</span><span class="n">removed_vars</span><span class="p">)</span>
        <span class="c1">#convert to namedtuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">summary_</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span><span class="n">summary_</span><span class="o">.</span><span class="n">keys</span><span class="p">())(</span><span class="o">*</span><span class="n">summary_</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="c1">#initialize</span>
        <span class="n">call_</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#fit model with selected features</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_vars</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1">#update X</span>
            <span class="n">Xnew</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">selected_vars</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">model_</span> <span class="o">==</span> <span class="s2">&quot;discrim&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disc_</span> <span class="o">=</span> <span class="n">DISCRIM</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span><span class="n">priors</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">priors</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span><span class="n">warn_message</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xnew</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">obj</span><span class="o">.</span><span class="n">model_</span> <span class="o">==</span> <span class="s2">&quot;candisc&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disc_</span> <span class="o">=</span> <span class="n">CANDISC</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">n_components</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span><span class="n">warn_message</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xnew</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            
            <span class="c1">#update call</span>
            <span class="n">call_</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="o">**</span><span class="n">call_</span><span class="p">,</span><span class="o">**</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disc_</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">target</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disc_</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span><span class="n">priors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disc_</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">priors</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Since only one feature is selected, </span><span class="si">{}</span><span class="s2"> procedure cannot be updated.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        
        <span class="c1">#convert to namedtuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;call&quot;</span><span class="p">,</span><span class="n">call_</span><span class="o">.</span><span class="n">keys</span><span class="p">())(</span><span class="o">*</span><span class="n">call_</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
               
        <span class="c1">#set model name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_</span> <span class="o">=</span> <span class="s2">&quot;stepdisc&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fits transformer to ``X`` and returns a transformed version of samples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : DataFrame of shape (n_samples, n_features)</span>
<span class="sd">            Training data, where ``n_samples`` is the number of samples and ``n_features`` is the number of features</span>
<span class="sd">        </span>
<span class="sd">        y : Series of shape (n_samples,)</span>
<span class="sd">            Target values. True labels for ``X``.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X_new : pandas DataFrame of shape (n_samples, n_components) or (n_samples, n_classes)</span>
<span class="sd">            Transformed samples, where ``n_components`` (resp. ``n_classes``) is the number of components (resp. classes).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="c1">#check if model has been updated</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;disc_&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Since only one feature is selected, </span><span class="si">{}</span><span class="s2"> procedure cannot be updated, therefore fit_transform cannot be applied.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">Xtot</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Project data to maximize class separation or dimensionality reduction </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : DataFrame of shape (n_samples, n_features)</span>
<span class="sd">            New data, where ``n_samples`` is the number of samples and ``n_features`` is the number of features.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X_new : DataFrame of shape (n_samples, n_components) or (n_samples, n_classes)</span>
<span class="sd">            Transformed data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#check if the estimator is fitted by verifying the presence of fitted attributes</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1">#check if model has been updated</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;disc_&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Since only one feature is selected, </span><span class="si">{}</span><span class="s2"> procedure cannot be updated, therefore fit_transform cannot be applied.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="c1">#check if X is an instance of class pd.DataFrame</span>
        <span class="c1">#---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
        <span class="n">check_is_dataframe</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>

        <span class="c1">#set index name as None</span>
        <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#check if X contains original features</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">Xtot</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The names of the features is not the same as the ones in the active features of the </span><span class="si">{}</span><span class="s2"> result&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">model_</span><span class="p">))</span>
        
        <span class="c1">#select original features</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">Xtot</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

        <span class="c1">#split X</span>
        <span class="n">split_X</span> <span class="o">=</span> <span class="n">splitmix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="c1">#extract elements</span>
        <span class="n">X_quanti</span><span class="p">,</span> <span class="n">X_quali</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_quanti</span><span class="p">,</span> <span class="n">n_quali</span> <span class="o">=</span> <span class="n">split_X</span><span class="o">.</span><span class="n">quanti</span><span class="p">,</span> <span class="n">split_X</span><span class="o">.</span><span class="n">quali</span><span class="p">,</span> <span class="n">split_X</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">split_X</span><span class="o">.</span><span class="n">k1</span><span class="p">,</span> <span class="n">split_X</span><span class="o">.</span><span class="n">k2</span>

        <span class="c1">#initialize DataFrame</span>
        <span class="n">Xcod</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1">#check if numerics variables</span>
        <span class="k">if</span> <span class="n">n_quanti</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#replace with numerics columns</span>
            <span class="n">Xcod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">X_quanti</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_quanti</span>
        
        <span class="c1">#check if categorical variables      </span>
        <span class="k">if</span> <span class="n">n_quali</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#active categorics</span>
            <span class="n">categorics</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">Xtot</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

            <span class="c1">#replace with dummies</span>
            <span class="n">Xcod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">categorics</span><span class="p">]</span> <span class="o">=</span> <span class="n">tab_disjunctive</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_quali</span><span class="p">,</span><span class="n">dummies_cols</span><span class="o">=</span><span class="n">categorics</span><span class="p">,</span><span class="n">prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="c1">#remove non selected variables</span>
        <span class="n">Xcod</span> <span class="o">=</span> <span class="n">Xcod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">cov_</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">disc_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xcod</span><span class="p">)</span></div>

</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Duvérier DJIFACK ZEBAZE.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>